
2021-04-09
## React Notes...
### Use redux-saga action in react hook - code example snippet

* useSelector: 從 state 抓取相對應的資料 map 進來
* useDispatch: dispatch action


```js

import { useDispatch, useSelector } from 'react-redux';
import { fetchSomething } from 'oneofsaga.ts'l

const ExamleHookComp = () => {
    const dispatch = useDispatch();

 
    const {loading, error } = useSelector((state) => ({
        loading: state.customKey.loading,
        error: state.customKey.error
    });
   
    useEffect(() => {
        // componentDidMount
        // componentDidUpdate
        dispatch(fetchSomething())
        // return () => {
          // componentWillUnmount
        // };
    }, []);

    const errorContent = false;

    return (
        <>
            { loading }
        </>
    );
};


export default ExamleHookComp;

```


2021-04-11

### 使用 Moment.js 取得多久以前以及以小時為單位取得時間: (感謝同事的幫忙)

example:

```js
const targetTime = 'xxxx';              // 一個要計算的時間，可能是過去的某個時間點
const start = moment(targetTime);       // 使用 moment 初始化開始時間 (in ms)
const end = moment();                   // 結束時間以現在為主 (in ms)
const diff = end.diff(start);           // diff 出開始與結束時間
const duration = moment.duration(diff); // 取得 duration

console.log('duration', duration);
console.log('asHours', duration.asHours());
console.log('hours', duration.hours());
console.log('minutes', duration.minutes());
console.log('seconds', duration.seconds());

const formated = `${Math.floor(duration.asHours())} hr ${duration.minutes()} min ${duration.seconds()} sec`;
return formated;
```


### 使用 gson 爬取文字內容並轉成 JSON

假設有個 API 帶入這樣的字串當作參數:

"[
   {
      "content":"test"
   },
   {
      "content":"test2"
   },
   {
      "content":"test3"
   }
]"

但在 Spring boot request 中取得這個參數時需要轉換成物件，可以使用 GSON 處理:

```java
// example
@RequestMapping(value = "", method = RequestMethod.POST)

public ResponseEntity add(@RequestParam(value = "specs", defaultValue = "") String specs ) {

    // 略...
    Gson gson = new Gson();
    // ProductSpecs 是一個 entity 的 class

    ProductSpecs[] specsArray = gson.fromJson(specs, ProductSpecs[].class);
    for(ProductSpecs spec : specsArray) {
        System.out.println(spec);
    }
}
```

log 出來會看到:

```log
ProductSpecs(id=0, product=null, isPublished=1, content=test)
ProductSpecs(id=0, product=null, isPublished=1, content=test2)
ProductSpecs(id=0, product=null, isPublished=1, content=test3)
```

